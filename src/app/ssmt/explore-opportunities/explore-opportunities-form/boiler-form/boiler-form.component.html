<div class="checkbox" #formElement>
  <label class="group-label" for="adjustBoilerData">
    <input type="checkbox" id="adjustBoilerData" (focus)="focusField('default')" (change)="toggleBoilerData()"
      [(ngModel)]="showBoilerData" /> Adjust Boiler Operation
  </label>
</div>
<ul *ngIf="showBoilerData">

  <li class="explore-opps-item">
    <div class="checkbox">
      <label for="modifyCombustionEfficiency">
        <input type="checkbox" id="modifyCombustionEfficiency" (focus)="focusField('combustionEfficiency')"
          (change)="toggleCombustionEfficiency()" [(ngModel)]="showCombustionEfficiency" /> Adjust Boiler Combustion
        Efficiency
      </label>
    </div>
  </li>

  <li *ngIf="showCombustionEfficiency" class="explore-opps-item">
    <form [formGroup]="baselineForm" class="explore-opps-form">
      <div class="text-center">
        <label for="baselineCombustionEfficiency" class="baseline-value-label">Baseline Combustion Efficiency</label>
        <div class="text-muted text-center baseline-value-input mt-1">{{ baselineForm.controls.combustionEfficiency.value }}%</div>
        <span class="alert-danger pull-right small"
        *ngIf="baselineForm.controls.combustionEfficiency.invalid && !baselineForm.controls.combustionEfficiency.pristine">
        <span *ngIf="baselineForm.controls.combustionEfficiency.errors.required">Value Required</span>
          <span *ngIf="baselineForm.controls.combustionEfficiency.errors.max">Value can't be greater than
            {{baselineForm.controls.combustionEfficiency.errors.max.max}} %.</span>
            <span *ngIf="baselineForm.controls.combustionEfficiency.errors.min">Value can't be less than
              {{baselineForm.controls.combustionEfficiency.errors.min.min}} %.</span>
            </span>
        </div>
      </form>
      <form [formGroup]="modificationForm" class="explore-opps-form">
        <div class="form-group explore-opps-formgroup">
          <label for="modificationCombustionEfficiency" class="mod-value-label">Modification Combustion Efficiency</label>
          <div class="input-group">
            <input name="modificationCombustionEfficiency" type="number" step="any" id="modificationCombustionEfficiency"
            class="form-control" (focus)="focusField('combustionEfficiency')" (input)="save()"
            formControlName="combustionEfficiency" />
            <span class="input-group-addon units">%</span>
          </div>
          <span class="alert-danger pull-right small"
          *ngIf="modificationForm.controls.combustionEfficiency.invalid && !modificationForm.controls.combustionEfficiency.pristine">
          <span *ngIf="modificationForm.controls.combustionEfficiency.errors.required">Value Required</span>
          <span *ngIf="modificationForm.controls.combustionEfficiency.errors.max">Value can't be greater than
            {{modificationForm.controls.combustionEfficiency.errors.max.max}} %.</span>
            <span *ngIf="modificationForm.controls.combustionEfficiency.errors.min">Value can't be less than
              {{modificationForm.controls.combustionEfficiency.errors.min.min}} %.</span>
            </span>
          </div>
        </form>
  </li>
  <hr *ngIf="showCombustionEfficiency">

  <li class="explore-opps-item">
    <div class="checkbox">
      <label for="modifyFuelType">
        <input type="checkbox" id="modifyFuelType" (focus)="focusField('fuel')" (change)="toggleFuelType()"
          [(ngModel)]="showFuelType" />
        Change Fuel Type
      </label>
    </div>
  </li>

  <li *ngIf="showFuelType" class="explore-opps-item">
    <form [formGroup]="baselineForm" class="explore-opps-form">
      <div class="text-center">
        <label for="baselineFuelType" class="baseline-value-label">Baseline Fuel Type</label>
        <div class="text-muted text-center baseline-value-input mt-1">
          <span *ngIf="baselineForm.value.fuelType == 0">Solid/Liquid</span>
          <span *ngIf="baselineForm.value.fuelType == 1">Gas</span>
        </div>
      </div>
  </form>
  <form [formGroup]="modificationForm" class="explore-opps-form">
    <div class="form-group explore-opps-formgroup">
      <label for="modificationFuelType" class="mod-value-label">Modification Fuel Type</label>
      <select name="modificationFuelType" id="modificationFuelType" class="form-control w-100"
      (focus)="focusField('fuelType')" (change)="setFuelTypes(true)" formControlName="fuelType">
      <option [ngValue]="0">Solid/Liquid</option>
            <option [ngValue]="1">Gas</option>
          </select>
        </div>
    </form>
  </li>

  <li *ngIf="showFuelType" class="explore-opps-item">
    <form [formGroup]="baselineForm" class="explore-opps-form">
      <div class="text-center">
        <label for="baselineFuel" class="baseline-value-label">Baseline Fuel</label>
        <div class="text-muted text-center baseline-value-input mt-1">{{baselineFuelOptions[baselineForm.value.fuel].substance }}</div>
    </div>
    </form>
    <form [formGroup]="modificationForm" class="explore-opps-form">
          <div class="form-group explore-opps-formgroup">
            <label for="modificationFuel" class="mod-value-label">Modification Fuel</label>
            <select name="modificationFuel" id="modificationFuel" class="form-control w-100" (focus)="focusField('fuel')"
            (change)="save()" formControlName="fuel">
            <option *ngFor="let option of modificationFuelOptions" [ngValue]="option.id">{{option.substance}}</option>
          </select>
        </div>
      </form>
  </li>
  <hr *ngIf="showFuelType">

  <li class="explore-opps-item">
    <div class="checkbox">
      <label for="modifyBlowdownRate">
        <input type="checkbox" id="modifyBlowdownRate" (focus)="focusField('blowdownRate')"
          (change)="toggleBlowdownRate()" [(ngModel)]="showBlowdownRate" /> Adjust Blowdown Rate
      </label>
    </div>
  </li>

  <li *ngIf="showBlowdownRate" class="explore-opps-item">
    <form [formGroup]="baselineForm" class="explore-opps-form">
      <div class="text-center">
        <label for="baselineBlowdownRate" class="baseline-value-label">Baseline Blowdown Rate
          <!-- <span class="form-text small">Calculate Blowdown Rate</span> -->
        </label>
        <div class="text-muted text-center baseline-value-input mt-1">{{baselineForm.value.blowdownRate }}% </div>

        </div>
      </form>
      <form class="explore-opps-form" [formGroup]="modificationForm">
        <div class="form-group explore-opps-formgroup">
          <label for="modificationBlowdownRate" class="mod-value-label">Modification Blowdown Rate
          </label>
          <div class="input-group">
            <input name="modificationBlowdownRate" type="number" step="any" id="modificationBlowdownRate"
            class="form-control" (focus)="focusField('blowdownRate')" (input)="save()" formControlName="blowdownRate" />
            <span class="input-group-addon units">%</span>
          </div>
          <a class="form-text small click-link" (click)="openBlowdownRateModal()">Calculate Blowdown Rate</a>

          </div>
        </form>
      </li>
  <hr *ngIf="showBlowdownRate">

  <li class="explore-opps-item">
    <div class="checkbox">
      <label for="modifyBlowdownFlashed">
        <input type="checkbox" id="modifyBlowdownFlashed" (focus)="focusField('blowdownFlashed')"
          (change)="toggleBlowdownFlashed()" [(ngModel)]="showBlowdownFlashed" /> Blowdown Flash to Low Pressure
      </label>
    </div>
  </li>

  <li class="explore-opps-item">
      <form class="explore-opps-form" [formGroup]="baselineForm" *ngIf="showBlowdownFlashed">
        <div class="text-center">
          <label for="baselineBlowdownFlashed" class="baseline-value-label">Baseline Blowdown Flashed</label>
          <div class="text-muted text-center baseline-value-input mt-1">
            <span *ngIf="baselineForm.value.blowdownFlashed == true">Yes</span>
            <span *ngIf="baselineForm.value.blowdownFlashed == false">No</span>
          </div>
      </div>
    </form>
    <form class="explore-opps-form" [formGroup]="modificationForm" *ngIf="showBlowdownFlashed">
      <div class="form-group explore-opps-formgroup">
        <label for="modificationBlowdownFlashed" class="mod-value-label">Modification Blowdown Flashed</label>
        <select name="modificationBlowdownFlashed" id="modificationBlowdownFlashed" class="form-control w-100"
        (focus)="focusField('blowdownFlashed')" (change)="save()" formControlName="blowdownFlashed">
        <option [ngValue]="true">Yes</option>
        <option [ngValue]="false">No</option>
      </select>
    </div>
  </form>
  </li>
  <hr *ngIf="showBlowdownFlashed">


  <li class="explore-opps-item">
    <div class="checkbox">
      <label for="modifyPreheatMakeupWater">
        <input type="checkbox" id="modifyPreheatMakeupWater" (focus)="focusField('preheatMakeupWater')"
          (change)="togglePreheatBlowdownWater()" [(ngModel)]="showPreheatBlowdownWater" /> Preheat Makeup Water with
        Blowdown
      </label>
    </div>
  </li>

  <li class="explore-opps-item" *ngIf="showPreheatBlowdownWater">
    <form class="explore-opps-form" [formGroup]="baselineForm">
      <div class="text-center">
        <label for="baselinePreheatBlowdownWater" class="baseline-value-label">Baseline Preheat Make-up Water</label>
        <div class="text-muted text-center baseline-value-input mt-1">
          <span *ngIf="baselineForm.value.preheatMakeupWater == true">Yes</span>
          <span *ngIf="baselineForm.value.preheatMakeupWater == false">No</span>
        </div>
      </div>
    </form>
    <form class="explore-opps-form" [formGroup]="modificationForm">
      <div class="form-group explore-opps-formgroup">
        <label for="modificationPreheatBlowdownWater" class="baseline-value-label">Modification Preheat Make-up Water</label>
        <select name="modificationPreheatBlowdownWater" id="modificationPreheatBlowdownWater" class="form-control w-100"
          (focus)="focusField('preheatMakeupWater')" (change)="save()" formControlName="preheatMakeupWater">
          <option [ngValue]="true">Yes</option>
          <option [ngValue]="false">No</option>
        </select>
      </div>
    </form>
    </li>

    <li class="d-flex justify-content-end" [ngClass]="{'justify-content-between': baselineForm.controls.approachTemperature.value}" *ngIf="showPreheatBlowdownWater">
    <form *ngIf="baselineForm.controls.approachTemperature.value" class="explore-opps-form" [formGroup]="baselineForm">
      <div class="text-center">
        <label for="baselineApproachTemperature" class="baseline-value-label">Baseline Approach Temperature</label>
        <div class="text-muted baseline-value-input mt-1">{{ baselineForm.controls.approachTemperature.value}} 
          <span [innerHTML]="settings.steamTemperatureMeasurement | settingsLabel"></span>
      </div>

      </div>
    </form>
    <form class="explore-opps-form" [formGroup]="modificationForm">
      <div class="form-group explore-opps-formgroup">
        <label for="modificationApproachTemperature" class="mod-value-label">Modification Approach Temperature</label>
        <div class="input-group">
          <input name="modificationApproachTemperature" type="number" step="any" id="modificationApproachTemperature"
            class="form-control" (focus)="focusField('approachTemperature')" (input)="save()"
            formControlName="approachTemperature" />
          <span class="units input-group-addon"
            [innerHTML]="settings.steamTemperatureMeasurement | settingsLabel"></span>
        </div>
        <span class="alert-danger pull-right small"
          *ngIf="modificationForm.controls.approachTemperature.invalid && !modificationForm.controls.approachTemperature.pristine">
          <span *ngIf="modificationForm.controls.approachTemperature.errors.min">Value can't be less than
            {{modificationForm.controls.approachTemperature.errors.min.min}}
            <span [innerHTML]="settings.steamTemperatureMeasurement | settingsLabel"></span>.</span>
        </span>
      </div>
    </form>
  </li>
  <hr *ngIf="showPreheatBlowdownWater">


  <li class="explore-opps-item">
    <div class="checkbox">
      <label for="modifySteamTemperature">
        <input type="checkbox" id="modifySteamTemperature" (focus)="focusField('steamTemperature')"
          (change)="toggleInitialSteamTemperature()" [(ngModel)]="showInitialSteampTemperature" /> Change Steam
        Generation Conditions
      </label>
    </div>
  </li>

  <li class="explore-opps-item" *ngIf="showInitialSteampTemperature">
    <form [formGroup]="baselineForm" class='explore-opps-form'>
      <div class="text-center">
        <label for="baselineSteamTemperature" class="baseline-value-label">Baseline Initial Steam Temperature</label>
        <div class="text-muted baseline-value-input mt-1">{{ baselineForm.controls.steamTemperature.value}} 
          <span [innerHTML]="settings.steamTemperatureMeasurement | settingsLabel"></span>
      </div>

      </div>
    </form>
    <form [formGroup]="modificationForm" class="explore-opps-form">
      <div class="form-group explore-opps-formgroup">
        <label for="modificationSteamTemperature" class="mod-value-label">Modification Initial Steam Temperature</label>
        <div class="input-group">
          <input name="modificationSteamTemperature" type="number" step="any" id="modificationSteamTemperature"
            class="form-control" (focus)="focusField('steamTemperature')" (input)="save()"
            formControlName="steamTemperature" />
          <span class="units input-group-addon"
            [innerHTML]="settings.steamTemperatureMeasurement | settingsLabel"></span>
        </div>
        <span class="alert-danger pull-right small"
          *ngIf="modificationForm.controls.steamTemperature.invalid && !modificationForm.controls.steamTemperature.pristine">
          <span *ngIf="modificationForm.controls.steamTemperature.errors.required">Value Required</span>
          <span *ngIf="modificationForm.controls.steamTemperature.errors.max">Value can't be greater than
            {{modificationForm.controls.steamTemperature.errors.max.max}}
            <span [innerHTML]="settings.steamTemperatureMeasurement | settingsLabel"></span>.</span>
          <span *ngIf="modificationForm.controls.steamTemperature.errors.min">Value can't be less than
            {{modificationForm.controls.steamTemperature.errors.min.min}}
            <span [innerHTML]="settings.steamTemperatureMeasurement | settingsLabel"></span>.</span>
        </span>
      </div>
    </form>
  </li>
  <hr *ngIf="showInitialSteampTemperature">


  <li class="explore-opps-item">
    <div class="checkbox">
      <label for="modifyDeaeratorConditions">
        <input type="checkbox" id="modifyDeaeratorConditions" (focus)="focusField('deaeratorPressure')"
          (change)="toggleDeaeratorConditions()" [(ngModel)]="showDeaeratorConditions" /> Change Deaerator Operating
        Conditions
      </label>
    </div>
  </li>

  <li class="explore-opps-item" *ngIf="showDeaeratorConditions">
    <form class="explore-opps-form" [formGroup]="baselineForm">
      <div class="text-center">
        <label for="baselineDeaeratorPressure" class="baseline-value-label">Baseline Deaerator Pressure</label>
        <div class="text-muted baseline-value-input mt-1">{{ baselineForm.controls.deaeratorPressure.value | number: '1.0-0'}} 
          <span [innerHTML]="settings.steamPressureMeasurement | settingsLabel"></span>
      </div>

      </div>
    </form>
    <form class="explore-opps-form" [formGroup]="modificationForm">
      <div class="form-group explore-opps-formgroup">
        <label for="modificationDeaeratorPressure" class="mod-value-label">Modification Deaerator Pressure</label>
        <div class="input-group">
          <input name="modificationDeaeratorPressure" type="number" step="any" id="modificationDeaeratorPressure"
            class="form-control" (focus)="focusField('deaeratorPressure')" (input)="save()"
            formControlName="deaeratorPressure" />
          <span class="units input-group-addon" [innerHTML]="settings.steamPressureMeasurement | settingsLabel"></span>
        </div>
        <span class="alert-danger pull-right small"
          *ngIf="modificationForm.controls.deaeratorPressure.invalid && !modificationForm.controls.deaeratorPressure.pristine">
          <span *ngIf="modificationForm.controls.deaeratorPressure.errors.required">Value Required</span>
          <span *ngIf="modificationForm.controls.deaeratorPressure.errors.max">Value can't be greater than
            {{modificationForm.controls.deaeratorPressure.errors.max.max}} <span
              [innerHTML]="settings.steamPressureMeasurement | settingsLabel"></span>.</span>
          <span *ngIf="modificationForm.controls.deaeratorPressure.errors.min">Value can't be less than
            {{modificationForm.controls.deaeratorPressure.errors.min.min}} <span
              [innerHTML]="settings.steamPressureMeasurement | settingsLabel"></span>.</span>
        </span>
      </div>
    </form>
  </li>

  <li class="explore-opps-item" *ngIf="showDeaeratorConditions">
    <form class="explore-opps-form" [formGroup]="baselineForm">
      <div class="text-center">
        <label for="baselineDeaeratorVentRate" class="baseline-value-label">Baseline Deaerator Vent Rate</label>
        <div class="text-muted text-center baseline-value-input mt-1">{{ baselineForm.controls.deaeratorVentRate.value }}%</div>

      </div>
    </form>
    <form class="explore-opps-form" [formGroup]="modificationForm">
      <div class="form-group explore-opps-formgroup">
        <label for="modificationDeaeratorVentRate" class="mod-value-label">Modification Deaerator Vent Rate</label>
        <div class="input-group">
          <input name="modificationDeaeratorVentRate" type="number" step="any" id="modificationDeaeratorVentRate"
            class="form-control" (focus)="focusField('deaeratorVentRate')" (input)="save()"
            formControlName="deaeratorVentRate" />
          <span class="units input-group-addon">%</span>
        </div>
      </div>
      <span class="alert-danger pull-right small"
        *ngIf="modificationForm.controls.deaeratorVentRate.invalid && !modificationForm.controls.deaeratorVentRate.pristine">
        <span *ngIf="modificationForm.controls.deaeratorVentRate.errors.required">Value Required</span>
        <span *ngIf="modificationForm.controls.deaeratorVentRate.errors.max">Value can't be greater than
          {{modificationForm.controls.deaeratorVentRate.errors.max.max}} %.</span>
        <span *ngIf="modificationForm.controls.deaeratorVentRate.errors.min">Value can't be less than
          {{modificationForm.controls.deaeratorVentRate.errors.min.min}} %.</span>
      </span>
    </form>
  </li>
</ul>

<app-blowdown-rate-modal *ngIf="showBlowdownRateModal" (emitClose)="closeBlowdownRateModal()" [width]="formWidth"
  [form]="modificationForm" (emitSave)="saveAndCloseBlowdownRateModal()">
</app-blowdown-rate-modal>