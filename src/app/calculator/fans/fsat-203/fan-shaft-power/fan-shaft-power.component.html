<form [formGroup]="shaftPowerForm" *ngIf="shaftPowerForm">
  <label class="group-label">
    <span class="step-number">4</span>Fan Shaft Power
    <span class="fa fa-exclamation-circle pull-right" *ngIf="!shaftPowerDone"></span>
    <span class="fa fa-check pull-right" *ngIf="shaftPowerDone"></span>
  </label>
  <div class="form-group">
    <label for="isMethodOne">Method for Establishing Fan Input Power</label>
    <select class="form-control" name="isMethodOne" formControlName="isMethodOne" id="isMethodOne" (change)="save()" (focus)="focusField('isMethodOne')">
      <option [ngValue]="true">Know Motor Input Power</option>
      <option [ngValue]="false">Calculate Motor Input Power</option>
    </select>
  </div>
  <label class="group-label group-label-2">Motor Nameplate Details</label>
  <div class="form-group">
    <label for="ratedHP">Rated Motor Power</label>
    <select name="ratedHP" class="form-control number-input-field" id="ratedHP" formControlName="ratedHP" (change)="save()" (focus)="focusField('ratedHP')">
      <option *ngFor="let option of horsePowers" [ngValue]="option">{{option}} {{settings.powerMeasurement}}</option>
    </select>
  </div>
  <div class="form-group">
    <label for="synchronousSpeed">Synchronous Speed</label>
    <div class="input-group">
      <input name="synchronousSpeed" type="number" step="any" class="form-control" formControlName="synchronousSpeed" id="synchronousSpeed"
        (input)="save()" (focus)="focusField('synchronousSpeed')" onfocus="this.select();">
      <span class="input-group-addon units">rpm</span>
    </div>
    <span class="alert-danger pull-right small" *ngIf="shaftPowerForm.controls.synchronousSpeed.invalid && !shaftPowerForm.controls.synchronousSpeed.pristine">
      <span *ngIf="shaftPowerForm.controls.synchronousSpeed.errors.required">Value Required</span>
    </span>
  </div>
  <div class="form-group">
    <label for="frequency">Line Frequency</label>
    <select name="frequency" class="form-control number-input-field" id="frequency" formControlName="frequency" (focus)="focusField('lineFrequency')"
      (change)="save()">
      <option *ngFor="let frequency of frequencies" [ngValue]="frequency">{{frequency}}</option>
    </select>
  </div>
  <div class="form-group">
    <label for="efficiencyClass">Efficiency Class</label>
    <select name="efficiencyClass" class="form-control select-input-field" id="efficiencyClass" formControlName="efficiencyClass"
      (change)="save()" (focus)="focusField('efficiencyClass')">
      <option *ngFor="let efficiencyClass of efficiencyClasses" [ngValue]="efficiencyClass">{{efficiencyClass}}</option>
    </select>
  </div>
  <div class="form-group">
    <label for="npv">Name Plate Voltage</label>
    <div class="input-group">
      <input name="npv" type="number" step="any" class="form-control" formControlName="npv" id="npv" (input)="save()" (focus)="focusField('npv')"
        onfocus="this.select();">
      <span class="input-group-addon units">V</span>
    </div>
    <span class="alert-danger pull-right small" *ngIf="shaftPowerForm.controls.npv.invalid && !shaftPowerForm.controls.npv.pristine">
      <span *ngIf="shaftPowerForm.controls.npv.errors.required">Value Required</span>
      <span *ngIf="shaftPowerForm.controls.npv.errors.max">Value can't be greater than {{shaftPowerForm.controls.npv.errors.max.max}}.</span>
      <span *ngIf="shaftPowerForm.controls.npv.errors.min">Value can't be less than {{shaftPowerForm.controls.npv.errors.min.min}}.</span>
    </span>
  </div>
  <div class="form-group">
    <label for="fla">Full Load Amps
      <a class="form-text small click-link" id="flaHelp" (click)="estimateFla()">Estimate Full-Load Amps</a>
    </label>
    <div class="input-group">
      <input name="fla" type="number" step="any" class="form-control" formControlName="fla" id="fla" (input)="save()" (focus)="focusField('fla')"
        onfocus="this.select();">
      <span class="input-group-addon units">A</span>
    </div>
    <span class="alert-danger pull-right small" *ngIf="shaftPowerForm.controls.fla.invalid && !shaftPowerForm.controls.fla.pristine">
      <span *ngIf="shaftPowerForm.controls.fla.errors.required">Value Required</span>
    </span>
  </div>
  <div class="form-group">
    <label for="powerFactorAtLoad">Power Factor at Load</label>
    <input name="powerFactorAtLoad" type="number" step="any" class="form-control" formControlName="powerFactorAtLoad" id="powerFactorAtLoad"
      (input)="calcMotorShaftPower()" (focus)="focusField('powerFactorAtLoad')" onfocus="this.select();">
    <span class="alert-danger pull-right small" *ngIf="shaftPowerForm.controls.powerFactorAtLoad.invalid && !shaftPowerForm.controls.powerFactorAtLoad.pristine">
      <span *ngIf="shaftPowerForm.controls.powerFactorAtLoad.errors.required">Value Required</span>
      <span *ngIf="shaftPowerForm.controls.powerFactorAtLoad.errors.max">Value can't be greater than {{shaftPowerForm.controls.powerFactorAtLoad.errors.max.max}}.</span>
      <span *ngIf="shaftPowerForm.controls.powerFactorAtLoad.errors.min">Value can't be less than {{shaftPowerForm.controls.powerFactorAtLoad.errors.min.min}}.</span>
    </span>
  </div>

  <div *ngIf="shaftPowerForm.controls.isMethodOne.value == false">
    <label class="group-label group-label-2">Motor Phase Data</label>

    <div class="form-group">
      <label class="hide-text">hidden text for formatting</label>
      <div class="input-group">
        <input type="text" class="form-control disabled-input" [disabled]="true" placeholder="Voltage (V)">
        <input type="text" class="form-control disabled-input" [disabled]="true" placeholder="Current (A)">
      </div>
      <label for="phase1">Phase 1
      </label>
      <div class="input-group">
        <input name="phase1Voltage" type="number" step="any" class="form-control amp-volt-input" formControlName="phase1Voltage"
          id="phase1Voltage" (input)="calcAverageVoltage()" (focus)="focusField('phase1Voltage')" onfocus="this.select();">
        <input name="phase1Amps" type="number" step="any" class="form-control amp-volt-input" formControlName="phase1Amps" id="phase1Amps"
          (input)="calcAverageAmps()" (focus)="focusField('phase1Amps')" onfocus="this.select();">
      </div>
      <label for="phase2">Phase 2
      </label>
      <div class="input-group">
        <input name="phase2Voltage" type="number" step="any" class="form-control amp-volt-input" formControlName="phase2Voltage"
          id="phase2Voltage" (input)="calcAverageVoltage()" (focus)="focusField('phase2Voltage')" onfocus="this.select();">
        <input name="phase2Amps" type="number" step="any" class="form-control amp-volt-input" formControlName="phase2Amps" id="phase2Amps"
          (input)="calcAverageAmps()" (focus)="focusField('phase2Amps')" onfocus="this.select();">
      </div>
      <label for="phase3">Phase 3
      </label>
      <div class="input-group">
        <input name="phase3Voltage" type="number" step="any" class="form-control amp-volt-input" formControlName="phase3Voltage"
          id="phase3Voltage" (input)="calcAverageVoltage()" (focus)="focusField('phase3Voltage')" onfocus="this.select();">
        <input name="phase3Amps" type="number" step="any" class="form-control amp-volt-input" formControlName="phase3Amps" id="phase3Amps"
          (input)="calcAverageAmps()" (focus)="focusField('phase3Amps')" onfocus="this.select();">
      </div>
      <label>Calculated Averages</label>
      <div class="input-group">
        <div class="area-val mx-auto">
          {{fanShaftPower.voltage | sigFigs: '6'}}
        </div>
        <div class="area-val mx-auto">
          {{fanShaftPower.amps | sigFigs: '6'}}
        </div>
      </div>
      <span class="alert-danger pull-right small" *ngIf="shaftPowerForm.controls.phase1Voltage.invalid && !shaftPowerForm.controls.phase1Voltage.pristine">
        <span *ngIf="shaftPowerForm.controls.phase1Voltage.errors.min">Phase 1 voltage can't be less than {{shaftPowerForm.controls.phase1Voltage.errors.min.min}}.</span>
      </span>
      <span class="alert-danger pull-right small" *ngIf="shaftPowerForm.controls.phase1Amps.invalid && !shaftPowerForm.controls.phase1Amps.pristine">
        <span *ngIf="shaftPowerForm.controls.phase1Amps.errors.min">Phase 1 current can't be less than {{shaftPowerForm.controls.phase1Amps.errors.min.min}}.</span>
      </span>
      <span class="alert-danger pull-right small" *ngIf="shaftPowerForm.controls.phase2Voltage.invalid && !shaftPowerForm.controls.phase2Voltage.pristine">
        <span *ngIf="shaftPowerForm.controls.phase2Voltage.errors.min">Phase 2 voltage can't be less than {{shaftPowerForm.controls.phase2Voltage.errors.min.min}}.</span>
      </span>
      <span class="alert-danger pull-right small" *ngIf="shaftPowerForm.controls.phase2Amps.invalid && !shaftPowerForm.controls.phase2Amps.pristine">
        <span *ngIf="shaftPowerForm.controls.phase2Amps.errors.min">Phase 2 current can't be less than {{shaftPowerForm.controls.phase2Amps.errors.min.min}}.</span>
      </span>
      <span class="alert-danger pull-right small" *ngIf="shaftPowerForm.controls.phase3Voltage.invalid && !shaftPowerForm.controls.phase3Voltage.pristine">
        <span *ngIf="shaftPowerForm.controls.phase3Voltage.errors.min">Phase 3 voltage can't be less than {{shaftPowerForm.controls.phase3Voltage.errors.min.min}}.</span>
      </span>
      <span class="alert-danger pull-right small" *ngIf="shaftPowerForm.controls.phase3Amps.invalid && !shaftPowerForm.controls.phase3Amps.pristine">
        <span *ngIf="shaftPowerForm.controls.phase3Amps.errors.min">Phase 3 current can't be less than {{shaftPowerForm.controls.phase3Amps.errors.min.min}}.</span>
      </span>
    </div>
  </div>
  <div class="form-group">
    <label for="motorShaftPower">Motor Input Power (H
      <sub>i</sub>)
    </label>
    <div class="input-group" *ngIf="shaftPowerForm.controls.isMethodOne.value == true">
      <input name="motorShaftPower" type="number" step="any" class="form-control" formControlName="motorShaftPower" id="motorShaftPower"
        (input)="save()" (focus)="focusField('motorShaftPower')" onfocus="this.select();">
      <span class="input-group-addon units">hp</span>
    </div>
    <div class="area-val" *ngIf="shaftPowerForm.controls.isMethodOne.value == false">
      {{fanShaftPower.motorShaftPower | sigFigs: '6'}} hp
    </div>
    <span class="alert-danger pull-right small" *ngIf="shaftPowerForm.controls.motorShaftPower.invalid && !shaftPowerForm.controls.motorShaftPower.pristine">
      <span *ngIf="shaftPowerForm.controls.motorShaftPower.errors.required">Value Required</span>
    </span>
  </div>

  <label class="group-label group-label-2">Motor and Drive Effiicencies</label>
  <div class="form-group">
    <label for="efficiencyMotor">Motor Efficiency at Load</label>
    <div class="input-group">
      <input name="efficiencyMotor" type="number" step="any" class="form-control" formControlName="efficiencyMotor" id="efficiencyMotor"
        (input)="save()" (focus)="focusField('efficiencyMotor')" onfocus="this.select();">
      <span class="input-group-addon units">%</span>
    </div>
    <span class="alert-danger pull-right small" *ngIf="shaftPowerForm.controls.efficiencyMotor.invalid && !shaftPowerForm.controls.efficiencyMotor.pristine">
      <span *ngIf="shaftPowerForm.controls.efficiencyMotor.errors.required">Value Required</span>
      <span *ngIf="shaftPowerForm.controls.efficiencyMotor.errors.max">Value can't be greater than {{shaftPowerForm.controls.efficiencyMotor.errors.max.max}}.</span>
      <span *ngIf="shaftPowerForm.controls.efficiencyMotor.errors.min">Value can't be less than {{shaftPowerForm.controls.efficiencyMotor.errors.min.min}}.</span>
    </span>
  </div>
  <div class="form-group">
    <label for="isVFD">Fan Equipped with a VFD</label>
    <div class="input-group">
      <select class="form-control" name="isVFD" formControlName="isVFD" id="isVFD" (change)="save()" (focus)="focusField('isVFD')">
        <option [ngValue]="'Yes'">Yes</option>
        <option [ngValue]="'No'">No</option>
      </select>
    </div>
  </div>
  <div class="form-group" *ngIf="fanShaftPower.isVFD == 'Yes'">
    <label for="efficiencyVFD">VFD Efficiency</label>
    <div class="input-group">
      <input name="efficiencyVFD" type="number" step="any" class="form-control" formControlName="efficiencyVFD" id="efficiencyVFD"
        (input)="save()" (focus)="focusField('efficiencyVFD')" onfocus="this.select();">
      <span class="input-group-addon units">%</span>
    </div>
    <span class="alert-danger pull-right small" *ngIf="shaftPowerForm.controls.efficiencyVFD.invalid && !shaftPowerForm.controls.efficiencyVFD.pristine">
      <span *ngIf="shaftPowerForm.controls.efficiencyVFD.errors.max">Value can't be greater than {{shaftPowerForm.controls.efficiencyVFD.errors.max.max}}.</span>
      <span *ngIf="shaftPowerForm.controls.efficiencyVFD.errors.min">Value can't be less than {{shaftPowerForm.controls.efficiencyVFD.errors.min.min}}.</span>
    </span>
  </div>
  <div class="form-group">
    <label for="driveType">Drive Type</label>
    <select class="form-control" name="driveType" formControlName="driveType" id="driveType" (change)="setBeltEfficiency()" (focus)="focusField('driveType')">
      <option *ngFor="let drive of driveTypes" [ngValue]="drive.name">{{drive.name}}</option>
    </select>
  </div>
  <div class="form-group">
    <label for="efficiencyBelt">Belt Efficiency</label>
    <div class="input-group">
      <input name="efficiencyBelt" type="number" step="any" class="form-control" formControlName="efficiencyBelt" id="efficiencyBelt"
        (input)="save()" (focus)="focusField('efficiencyBelt')" onfocus="this.select();">
      <span class="input-group-addon units">%</span>
    </div>
    <span class="alert-danger pull-right small" *ngIf="shaftPowerForm.controls.efficiencyBelt.invalid && !shaftPowerForm.controls.efficiencyBelt.pristine">
      <span *ngIf="shaftPowerForm.controls.efficiencyBelt.errors.required">Value Required</span>
      <span *ngIf="shaftPowerForm.controls.efficiencyBelt.errors.max">Value can't be greater than {{shaftPowerForm.controls.efficiencyBelt.errors.max.max}}.</span>
      <span *ngIf="shaftPowerForm.controls.efficiencyBelt.errors.min">Value can't be less than {{shaftPowerForm.controls.efficiencyBelt.errors.min.min}}.</span>
    </span>
  </div>
</form>