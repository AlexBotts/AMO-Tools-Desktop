<nav>
  <app-modify-conditions-tabs (changeTab)="changeTab($event)" [modifyTab]="modifyTab"></app-modify-conditions-tabs>
</nav>

<div class="modify-conditions">

  <!-- Baseline -->
  <div class="modification" (click)="togglePanel(baselineSelected)" [ngClass]="{'disabled': baselineSelected == false}">
    <div class="header">
      <h3>Baseline</h3>
    </div>
    <div class="losses-container">
      <!--<app-system-basics *ngIf="modifyTab == 'system-basics'"></app-system-basics>-->
      <app-pump-fluid *ngIf="modifyTab == 'pump-fluid'" [selected]="baselineSelected" [saveClicked]="saveClicked"
        [(psat)]="psat" (changeField)="changeField($event)" (saved)="save()"></app-pump-fluid>
      <app-motor *ngIf="modifyTab == 'motor'" [selected]="baselineSelected" [saveClicked]="saveClicked" [(psat)]="psat"
        (changeField)="changeField($event)" (saved)="save()"></app-motor>
      <app-field-data *ngIf="modifyTab == 'field-data'" [selected]="baselineSelected" [saveClicked]="saveClicked"
        [(psat)]="psat" (changeField)="changeField($event)" (saved)="save()"></app-field-data>
    </div>
  </div>


  <!-- Modifications Start -->
  <div class="modification" (click)="togglePanel(modifiedSelected)" *ngIf="_modifications.length != 0" [ngClass]="{'disabled': modifiedSelected == false}">
    
    <!-- Modification Header -->
    <div class="header">
      <h3>{{_modifications[modificationIndex].psat.name}}</h3>
      <button class="pull-right" (click)="toggleDropdown()" [disabled]="!modifiedSelected">
        <span class="fa fa-caret-down" *ngIf="!isDropdownOpen"></span>
        <span class="fa fa-caret-up" *ngIf="isDropdownOpen"></span>
      </button>
    </div>

    <!-- Forms -->
    <div class="losses-container" *ngIf="!isDropdownOpen && !showNotes">

      <div class="losses-header">
        Field Data
        <span class="pull-right" (click)="toggleNotes()">
          <i class="fa fa-sticky-note-o" aria-hidden="true" *ngIf="!showNotes"></i>
          <i class="fa fa-sticky-note" aria-hidden="true" *ngIf="showNotes"></i>
        </span> 
      </div>

      <!--<app-system-basics *ngIf="modifyTab == 'system-basics'"></app-system-basics>-->
      <app-pump-fluid *ngIf="modifyTab == 'pump-fluid'" [selected]="modifiedSelected" [saveClicked]="saveClicked"
        [(psat)]="_modifications[modificationIndex].psat" (changeField)="changeField($event)" (saved)="save()"></app-pump-fluid>
      <app-motor *ngIf="modifyTab == 'motor'" [selected]="modifiedSelected" [saveClicked]="saveClicked"
        [(psat)]="_modifications[modificationIndex].psat" (changeField)="changeField($event)" (saved)="save()"></app-motor>
      <app-field-data *ngIf="modifyTab == 'field-data'" [saveClicked]="saveClicked" [(psat)]="_modifications[modificationIndex].psat"
        (changeField)="changeField($event)" [selected]="modifiedSelected" (saved)="save()"></app-field-data>
    </div>


    <!-- Modifications List -->
    <div class="modifications-list" *ngIf="isDropdownOpen && !showNotes">
      <ul>
        <li *ngFor="let modification of _modifications">
          <button (click)="selectModification(modification)">{{modification.psat.name}}</button>
        </li>
        <li class="add-modification">
          <button (click)="addModification()">Add Modified Condition</button>
          <p>Data will be copied from <br/> your baseline operating condition</p>
        </li>
      </ul>
    </div>


    <!-- Notes Form & Display -->
    <div class="losses-container" *ngIf="!isDropdownOpen && showNotes">
      <app-modify-conditions-notes [(notes)]="_modifications[modificationIndex].notes" [currentTab]="modifyTab"></app-modify-conditions-notes>
    </div>

  </div>

  <!-- No content message -->
  <div class="no-data" *ngIf="_modifications.length == 0" (click)="addModification()">
    <h3>Now that you have setup your system and have baseline information, create duplicate baseline conditions to find efficiency opportunities.</h3>
    <button type="button">Add Modified Condition</button>
    <p>Data will be copied from your current baseline condition.</p>
  </div>

  <!-- Help Panel -->
  <app-help-panel [currentTab]="modifyTab" [currentField]="currentField"></app-help-panel>

</div>