<div class="d-flex flex-column output-summary">

  <h4 class="show-print">Opportunity Summary</h4>

  <table class="table table-striped table-hover">
    <tbody>
      <tr class="bold">
        <td *ngIf="inRollup">
          Use Opportunity
        </td>
        <td>
          Opportunity Name
        </td>
        <td>
          Utility
        </td>
        <td>
          Utility Savings
        </td>
        <td>

        </td>
        <td>
          Cost Savings
        </td>
        <td>
          Material Cost
        </td>
        <td>
          Labor Cost
        </td>
        <td>
          Engineering Cost
        </td>
        <td>
          Other Cost
        </td>
        <td>
          Total Cost
        </td>
        <td>
          Simple Payback
        </td>
      </tr>
      <tr *ngFor="let opportunity of opportunitySummaries"
        [ngClass]="{'selected-opportunity': inRollup == true && opportunity.selected == true}">
        <!--apply opportunity to rollup report-->
        <td class="text-center" *ngIf="inRollup">
          <input type="checkbox" [(ngModel)]="opportunity.selected" (change)="updateOpportunities()" />
        </td>
        <!--name-->
        <td>
          {{opportunity.opportunityName}}
        </td>
        <!--type-->
        <td *ngIf="opportunity.utilityType != 'Mixed'">
          {{opportunity.utilityType}}
        </td>
        <td *ngIf="opportunity.utilityType == 'Mixed'">
          <span *ngFor="let result of opportunity.mixedIndividualResults">
            {{result.utilityType}} <br>
          </span>
        </td>
        <!--energy savings-->
        <td *ngIf="opportunity.utilityType != 'Mixed'">
          {{opportunity.totalEnergySavings | number:'1.0-0'}}
        </td>
        <td *ngIf="opportunity.utilityType == 'Mixed'">
          <span *ngFor="let result of opportunity.mixedIndividualResults">
            {{result.totalEnergySavings | number:'1.0-0'}}<br>
          </span>
        </td>
        <!--unit-->
        <td>
          <span *ngIf="opportunity.utilityType == 'Electricity'">kWh</span>

          <span *ngIf="opportunity.utilityType == 'Compressed Air'">
            <span *ngIf="settings.unitsOfMeasure == 'Imperial'">kSCF</span>
            <span *ngIf="settings.unitsOfMeasure == 'Metric'">Nm<sup>3</sup></span>
          </span>

          <span *ngIf="opportunity.utilityType == 'Water' || opportunity.utilityType == 'Waste Water'">
            <span *ngIf="settings.unitsOfMeasure == 'Imperial'">kgal</span>
            <span *ngIf="settings.unitsOfMeasure == 'Metric'">m<sup>3</sup></span>
          </span>

          <span *ngIf="opportunity.utilityType == 'Steam'">
            <span *ngIf="settings.unitsOfMeasure == 'Imperial'">klb</span>
            <span *ngIf="settings.unitsOfMeasure == 'Metric'">tonne</span>
          </span>

          <span *ngIf="opportunity.utilityType == 'Natural Gas' || opportunity.utilityType == 'Other Fuel'">
            <span *ngIf="settings.unitsOfMeasure == 'Imperial'">MMBtu</span>
            <span *ngIf="settings.unitsOfMeasure == 'Metric'">MJ</span>
          </span>
          <!--mixed-->
          <span *ngIf="opportunity.utilityType == 'Mixed'">
            <span *ngFor="let result of opportunity.mixedIndividualResults">
              <span *ngIf="result.utilityType == 'Electricity'">kWh</span>

              <span *ngIf="result.utilityType == 'Compressed Air'">
                <span *ngIf="settings.unitsOfMeasure == 'Imperial'">SCF</span>
                <span *ngIf="settings.unitsOfMeasure == 'Metric'">Nm<sup>3</sup></span>
              </span>

              <span *ngIf="result.utilityType == 'Steam'">
                <span *ngIf="settings.unitsOfMeasure == 'Imperial'">klb</span>
                <span *ngIf="settings.unitsOfMeasure == 'Metric'">tonne</span>
              </span>

              <span *ngIf="result.utilityType == 'Water' || result.utilityType == 'Waste Water'">
                <span *ngIf="settings.unitsOfMeasure == 'Imperial'">kgal</span>
                <span *ngIf="settings.unitsOfMeasure == 'Metric'">m<sup>3</sup></span>
              </span>

              <span *ngIf="result.utilityType == 'Natural Gas' || result.utilityType == 'Other Fuel'">
                <span *ngIf="settings.unitsOfMeasure == 'Imperial'">MMBtu</span>
                <span *ngIf="settings.unitsOfMeasure == 'Metric'">MJ</span>
              </span>
              <br>
            </span>
          </span>
        </td>
        <!--cost savings-->
        <td *ngIf="opportunity.utilityType != 'Mixed'">
          {{opportunity.costSavings | currency:'USD'}}
        </td>
        <td *ngIf="opportunity.utilityType == 'Mixed'">
          <span *ngFor="let result of opportunity.mixedIndividualResults">
            {{result.costSavings | currency:'USD'}}<br>
          </span>
        </td>
        <!--material cost-->
        <td>
          {{getMaterialCost(opportunity.opportunityCost) | currency:'USD'}}
        </td>
        <!--labor cost-->
        <td>
          {{getLaborCost(opportunity.opportunityCost) | currency:'USD'}}
        </td>
        <!--engineering cost-->
        <td>
          {{getEngineeringCost(opportunity.opportunityCost) | currency:'USD'}}
        </td>
        <!--other cost-->
        <td>
          {{getOtherCost(opportunity.opportunityCost) | currency:'USD'}}
        </td>
        <!--total cost-->
        <td>
          {{opportunity.totalCost | currency:'USD'}}
        </td>
        <!--payback-->
        <td>
          {{opportunity.payback | number:'1.0-2'}}
        </td>
      </tr>
    </tbody>
  </table>
</div>