<div class="d-flex modify-conditions panel-container" *ngIf="selectedCalc == 'none'">
  <div class="panel-column scroll-item" [ngStyle]="{'height.px': containerHeight}">
    <div class="header mr-2 ml-2">
      <h3>Treasure Chest Inventory</h3>
    </div>
    <div class="col-12" *ngFor="let replacement of treasureHunt.lightingReplacements; let index = index;">
      <app-lighting-replacement-card [replacement]="replacement" [settings]="settings" [index]="index"
        (emitEditLighting)="editLighting($event, index)"
        (emitEditOpportunitySheet)="editLightingReplacementOpportunitySheet($event, index)"
        (emitDeleteLightingReplacement)="showDeleteLightingModal($event, index)" [treasureHunt]="treasureHunt">
      </app-lighting-replacement-card>
    </div>
    <!-- <div class="col-12" *ngFor="let opportunitySheet of treasureHunt.opportunitySheets">
      <app-opportunity-sheet-card [opportunitySheet]="opportunitySheet"
        (emitEditOpportunitySheet)="editStandaloneOpportunitySheet($event)" [settings]="settings">
      </app-opportunity-sheet-card>
    </div> -->
  </div>
  <div class="d-flex flex-column scroll-item result-column" [ngStyle]="{'height.px': containerHeight}">
    <div class="d-flex flex-wrap tabs primary mr-2 ml-2">
      <div class="flex-fill panel-tab-item h-100" [ngClass]="{'active': tabSelect == 'results'}">
        <a class="border-left-0 h-100 d-flex justify-content-center align-items-center" (click)="setTab('results')">
          <div>Results</div>
        </a>
      </div>
      <div class="flex-fill panel-tab-item h-100" [ngClass]="{'active': tabSelect == 'help'}">
        <a class="h-100 d-flex justify-content-center align-items-center" (click)="setTab('help')">
          <div>Help</div>
        </a>
      </div>
    </div>
    <div class="d-flex justify-content-center mr-2 ml-2">
      <app-summary-card [treasureHunt]="treasureHunt" [settings]="settings"></app-summary-card>
    </div>
  </div>
</div>

<!--edit-->
<app-lighting-replacement *ngIf="selectedCalc == 'lighting-replacement'" [inTreasureHunt]="true"
  (emitSave)="saveEditLighting($event)" (emitCancel)="cancelEditCalc()"
  (emitAddOpportunitySheet)="showOpportunitySheetModal()" [settings]="settings"></app-lighting-replacement>

<app-standalone-opportunity-sheet *ngIf="selectedCalc == 'opportunity-sheet'" (emitCancel)="cancelEditCalc()"
  (emitSave)="saveEditOpportunity($event)" [settings]="settings" [(opportunitySheet)]="selectedEditOpportunitySheet">
</app-standalone-opportunity-sheet>


<div bsModal #saveCalcModal="bs-modal" class="modal fade" tabindex="-1" role="dialog"
  aria-labelledby="saveCalcModalLabel" aria-hidden="true" [config]="{backdrop: 'static'}">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header p-1">
        <h5 class="mb-0">Save Changes</h5>
        <!-- <button class="close" (click)="closeSaveCalcModal()">
          <span aria-hidden="true">&times;</span>
        </button> -->
      </div>
      <div class="modal-body text-center" *ngIf="isSaveLighting">
        <p class="help-text" *ngIf="!selectedEditOpportunitySheet">There is no opportunity sheet filled out for this
          opportunity. Would you like to add one
          before saving?</p>
        <p class="help-text" *ngIf="selectedEditOpportunitySheet">Would you like to edit your opportunity sheet before
          saving?</p>
        <a class="click-link" (click)="showOpportunitySheetModal()">
          <span class="fa fa-edit"></span>
        </a> <br>
        <a class="click-link small" (click)="showOpportunitySheetModal()" *ngIf="!selectedEditOpportunitySheet">+Add
          Opportunity Sheet</a>
        <a class="click-link small" (click)="showOpportunitySheetModal()" *ngIf="selectedEditOpportunitySheet">Edit
          Opportunity Sheet</a>
      </div>
      <div class="modal-body text-center" *ngIf="!isSaveLighting">
        <p class="help-text">Are you sure you want to save the changes to your existing opportunity? These changes
          cannot be
          undone.</p>
      </div>
      <div class="modal-footer p-1">
        <button class="btn btn-danger btn-sm pull-right" (click)="closeSaveCalcModal()">Cancel</button>
        <button class="btn btn-primary btn-sm pull-right" (click)="saveLighting()" *ngIf="isSaveLighting">Save</button>
        <button class="btn btn-primary btn-sm pull-right" (click)="saveEditOpportunitySheet()"
          *ngIf="!isSaveLighting">Save</button>
      </div>
    </div>
  </div>
</div>


<div bsModal #opportunitySheetModal="bs-modal" class="modal fade" tabindex="-1" role="dialog"
  aria-labelledby="opportunitySheetModalLabel" aria-hidden="true" [config]="{backdrop: 'static'}">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-body pl-0 pr-0" *ngIf="opportunitySheetModal.isShown">
        <app-opportunity-sheet (emitCancel)="hideOpportunitySheetModal()" (emitSave)="saveOpportunitySheet($event)"
          [(opportunitySheet)]="selectedEditOpportunitySheet">
        </app-opportunity-sheet>
      </div>
    </div>
  </div>
</div>

<div bsModal #deletedItemModal="bs-modal" class="modal fade" tabindex="-1" role="dialog"
  aria-labelledby="deletedItemModalLabel" aria-hidden="true" [config]="{backdrop: 'static'}">
  <div class="modal-dialog modal-sm">
    <div class="modal-content">
      <div class="modal-body p-2 text-center" *ngIf="deletedItemModal.isShown">
        Are you sure you want to delete "{{deleteItemName}}"?<br>
        <span class="small danger">This cannot be undone.</span>
      </div>
      <div class="modal-footer p-2 justify-content-end delete-modal">
        <button class="btn btn-danger" (click)="deleteItem()">Delete</button>
        <button class="btn btn-primary" (click)="cancelDelete()">Cancel</button>
      </div>
    </div>
  </div>
</div>