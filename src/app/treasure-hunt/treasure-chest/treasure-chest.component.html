<div class="d-flex modify-conditions panel-container skyline" *ngIf="selectedCalc == 'none'">
  <div class="scroll-item chest-column" [ngStyle]="{'height.px': containerHeight}">
    <div class="col-12">
      <app-treasure-chest-menu (emitChangeEnergyType)="setEnergyType($event)" [treasureHunt]="treasureHunt"
        (emitChangeCalculatorType)="setCaclulatorType($event)"></app-treasure-chest-menu>
    </div>
    <!-- <div class="d-flex flex-wrap tabs primary mr-2 ml-2 mb-2">
      <div class="flex-fill panel-tab-item h-100" [ngClass]="{'active': tabSelect == 'all'}">
        <a class="border-left-0 h-100 d-flex justify-content-center align-items-center" (click)="setTab('all')">
          <div>All Items ({{numItems}})</div>
        </a>
      </div>
      <div class="flex-fill panel-tab-item h-100" [ngClass]="{'active': tabSelect == 'lighting-replacement'}">
        <a class="h-100 d-flex justify-content-center align-items-center" (click)="setTab('lighting-replacement')">
          <div>Lighting Replacements ({{numLightingReplacements}})</div>
        </a>
      </div>
      <div class="flex-fill panel-tab-item h-100" [ngClass]="{'active': tabSelect == 'opportunity-sheet'}">
        <a class="h-100 d-flex justify-content-center align-items-center" (click)="setTab('opportunity-sheet')">
          <div>Opportunity Sheets ({{numOppSheets}})</div>
        </a>
      </div>
    </div> -->
    <!--lighting replacement-->
    <div
      *ngIf="(displayCalculatorType == 'All' || displayCalculatorType == 'Lighting Replacement') && (displayEnergyType == 'All' || displayEnergyType == 'Electricity')">
      <div class="col-12" *ngFor="let replacement of treasureHunt.lightingReplacements; let index = index;">
        <app-lighting-replacement-card [replacement]="replacement" [settings]="settings" [index]="index"
          (emitEditLighting)="editLighting($event, index)"
          (emitEditOpportunitySheet)="editItemOpportunitySheet($event, index, 'lightingReplacement')"
          (emitDeleteItem)="showDeleteItem($event, index, 'lightingReplacement')"
          [treasureHunt]="treasureHunt" (emitSaveTreasureHunt)="save()">
        </app-lighting-replacement-card>
      </div>
    </div>
    <!--replace existing motor-->
    <div
      *ngIf="(displayCalculatorType == 'All' || displayCalculatorType == 'Replace Existing Motor') && (displayEnergyType == 'All' || displayEnergyType == 'Electricity')">
      <div class="col-12" *ngFor="let replaceExistingMotor of treasureHunt.replaceExistingMotors; let index = index;">
        <app-replace-existing-motor-card [replaceExistingMotor]="replaceExistingMotor" [index]="index"
          (emitEditOpportunitySheet)="editItemOpportunitySheet($event, index, 'replaceExistingMotor')"
          [settings]="settings" [treasureHunt]="treasureHunt" (emitSaveTreasureHunt)="save()"
          (emitDeleteReplaceExistingMotor)="showDeleteItem($event, index, 'replaceExistingMotor')"
          (emitEditReplaceExistingMotor)="editReplaceExistingMotor($event, index)">
        </app-replace-existing-motor-card>
      </div>
    </div>
    <!--motor drive-->
    <div
      *ngIf="(displayCalculatorType == 'All' || displayCalculatorType == 'Motor Drive') && (displayEnergyType == 'All' || displayEnergyType == 'Electricity')">
      <div class="col-12" *ngFor="let motorDrive of treasureHunt.motorDrives; let index = index;">
        <app-motor-drive-card [motorDrive]="motorDrive" [index]="index"
          (emitEditOpportunitySheet)="editItemOpportunitySheet($event, index, 'motorDrive')" [settings]="settings"
          [treasureHunt]="treasureHunt" (emitSaveTreasureHunt)="save()"
          (emitDeleteItem)="showDeleteItem($event, index, 'motorDrive')" (emitEditItem)="editMotorDrive($event, index)">
        </app-motor-drive-card>
      </div>
    </div>
    <!--natural gas reduction-->
    <div
      *ngIf="(displayCalculatorType == 'All' || displayCalculatorType == 'Natural Gas Reduction') && (displayEnergyType == 'All' || displayEnergyType == 'Natural Gas')">
      <div class="col-12" *ngFor="let naturalGasReduction of treasureHunt.naturalGasReductions; let index = index;">
        <app-natural-gas-reduction-card [naturalGasReduction]="naturalGasReduction" [settings]="settings"
          [index]="index" (emitEditNaturalGasReduction)="editNaturalGasReduction($event, index)"
          (emitEditOpportunitySheet)="editItemOpportunitySheet($event, index, 'naturalGasReduction')"
          (emitDeleteItem)="showDeleteItem($event, index, 'naturalGasReduction')"
          [treasureHunt]="treasureHunt" (emitSaveTreasureHunt)="save()"></app-natural-gas-reduction-card>
      </div>
    </div>
    <!--electricity reduction-->
    <div
      *ngIf="(displayCalculatorType == 'All' || displayCalculatorType == 'Electricity Reduction') && (displayEnergyType == 'All' || displayEnergyType == 'Electricity')">
      <div class="col-12" *ngFor="let electricityReduction of treasureHunt.electricityReductions; let index = index;">
        <app-electricity-reduction-card [electricityReduction]="electricityReduction" [settings]="settings"
          [index]="index" (emitEditElectricityReduction)="editElectricityReduction($event, index)"
          (emitEditOpportunitySheet)="editItemOpportunitySheet($event, index, 'electricityReduction')"
          (emitDeleteItem)="showDeleteItem($event, index, 'electricityReduction')"
          [treasureHunt]="treasureHunt" (emitSaveTreasureHunt)="save()"></app-electricity-reduction-card>
      </div>
    </div>
    <!--compressed air reduction-->
    <div
      *ngIf="(displayCalculatorType == 'All' || displayCalculatorType == 'Compressed Air Reduction') && (displayEnergyType == 'All' || displayEnergyType == 'Compressed Air')">
      <div class="col-12" *ngFor="let compressedAirReduction of treasureHunt.compressedAirReductions; let index = index;">
        <app-compressed-air-reduction-card [compressedAirReduction]="compressedAirReduction" [settings]="settings"
          [index]="index" (emitEditCompressedAirReduction)="editCompressedAirReduction($event, index)"
          (emitEditOpportunitySheet)="editItemOpportunitySheet($event, index, 'compressedAirReduction')"
          (emitDeleteItem)="showDeleteItem($event, index, 'compressedAirReduction')"
          [treasureHunt]="treasureHunt" (emitSaveTreasureHunt)="save()"></app-compressed-air-reduction-card>
      </div>
    </div>
    <!--standalone opportunity sheet-->
    <div
      *ngIf="(displayCalculatorType == 'All' || displayCalculatorType == 'Opportunity Sheet') && (displayEnergyType == 'All' || displayEnergyType == 'Other')">
      <div class="col-12" *ngFor="let opportunitySheet of treasureHunt.opportunitySheets; let index = index;">
        <app-opportunity-sheet-card [opportunitySheet]="opportunitySheet" [index]="index"
          (emitEditOpportunitySheet)="editStandaloneOpportunitySheet($event)" [settings]="settings"
          [treasureHunt]="treasureHunt" (emitSaveTreasureHunt)="save()"
          (emitDeleteOpportunity)="showDeleteItem($event, index, 'opportunitySheet')">
        </app-opportunity-sheet-card>
      </div>
    </div>
  </div>
  <div class="d-flex scroll-item result-column justify-content-center mr-3 ml-3"
    [ngStyle]="{'height.px': containerHeight}">
    <!-- <div class="d-flex flex-wrap tabs primary mr-2 ml-2"> -->
    <!-- <div class="flex-fill panel-tab-item h-100" [ngClass]="{'active': helpTabSelect == 'results'}">
        <a class="border-left-0 h-100 d-flex justify-content-center align-items-center" (click)="setHelpTab('results')">
          <div>Results</div>
        </a>
      </div>
      <div class="flex-fill panel-tab-item h-100" [ngClass]="{'active': helpTabSelect == 'help'}">
        <a class="h-100 d-flex justify-content-center align-items-center" (click)="setHelpTab('help')">
          <div>Help</div>
        </a>
      </div>
    </div> -->
    <!-- <div class="d-flex"> -->
    <app-summary-card class="w-100" [treasureHunt]="treasureHunt" [settings]="settings"></app-summary-card>
    <!--   </div> -->
  </div>
</div>

<!--edit calcs-->
<app-lighting-replacement *ngIf="selectedCalc == 'lighting-replacement'" [inTreasureHunt]="true"
  (emitSave)="saveEditLighting($event)" (emitCancel)="cancelEditCalc()"
  (emitAddOpportunitySheet)="showOpportunitySheetModal()" [settings]="settings"
  [operatingHours]="treasureHunt.operatingHours"></app-lighting-replacement>

<app-standalone-opportunity-sheet *ngIf="selectedCalc == 'opportunity-sheet'" (emitCancel)="cancelEditCalc()"
  (emitSave)="saveEditOpportunity($event)" [settings]="settings" [(opportunitySheet)]="selectedEditOpportunitySheet">
</app-standalone-opportunity-sheet>

<app-replace-existing *ngIf="selectedCalc == 'replace-existing'" (emitCancel)="cancelEditCalc()"
  (emitSave)="saveEditReplaceExistingMotor($event)" [settings]="settings" [inTreasureHunt]="true"
  [opperatingHours]="opperatingHoursPerYear" (emitAddOpportunitySheet)="showOpportunitySheetModal()">
</app-replace-existing>

<app-motor-drive *ngIf="selectedCalc == 'motor-drive'" (emitCancel)="cancelEditCalc()"
  (emitSave)="saveEditMotorDrive($event)" [settings]="settings" [inTreasureHunt]="true"
  [opperatingHours]="opperatingHoursPerYear" (emitAddOpportunitySheet)="showOpportunitySheetModal()">
</app-motor-drive>

<app-natural-gas-reduction *ngIf="selectedCalc == 'natural-gas-reduction'" [inTreasureHunt]="true"
  (emitSave)="saveEditNaturalGasReduction($event)" (emitCancel)="cancelEditCalc()"
  (emitAddOpportunitySheet)="showOpportunitySheetModal()" [settings]="settings"
  [operatingHours]="opperatingHoursPerYear"></app-natural-gas-reduction>

<app-electricity-reduction *ngIf="selectedCalc == 'electricity-reduction'" [inTreasureHunt]="true"
  (emitSave)="saveEditElectricityReduction($event)" (emitCancel)="cancelEditCalc()"
  (emitAddOpportunitySheet)="showOpportunitySheetModal()" [settings]="settings"
  [operatingHours]="opperatingHoursPerYear"></app-electricity-reduction>

<div bsModal #saveCalcModal="bs-modal" class="modal fade" tabindex="-1" role="dialog"
  aria-labelledby="saveCalcModalLabel" aria-hidden="true" [config]="{backdrop: 'static'}">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header p-1">
        <h5 class="mb-0">Save Changes</h5>
        <!-- <button class="close" (click)="closeSaveCalcModal()">
          <span aria-hidden="true">&times;</span>
        </button> -->
      </div>
      <div class="modal-body text-center" *ngIf="itemType != 'opportunitySheet'">
        <p class="help-text" *ngIf="!selectedEditOpportunitySheet">There is no opportunity sheet filled out for this
          opportunity. Would you like to add one
          before saving?</p>
        <p class="help-text" *ngIf="selectedEditOpportunitySheet">Would you like to edit your opportunity sheet before
          saving?</p>
        <a class="click-link" (click)="showOpportunitySheetModal()">
          <span class="fa fa-edit"></span>
        </a> <br>
        <a class="click-link small" (click)="showOpportunitySheetModal()" *ngIf="!selectedEditOpportunitySheet">+Add
          Opportunity Sheet</a>
        <a class="click-link small" (click)="showOpportunitySheetModal()" *ngIf="selectedEditOpportunitySheet">Edit
          Opportunity Sheet</a>
      </div>
      <div class="modal-body text-center" *ngIf="itemType == 'opportunitySheet'">
        <p class="help-text">Are you sure you want to save the changes to your existing opportunity? These changes
          cannot be
          undone.</p>
      </div>
      <div class="modal-footer p-1">
        <button class="btn btn-danger btn-sm pull-right" (click)="hideSaveCalcModal()">Cancel</button>
        <button class="btn btn-primary btn-sm pull-right" (click)="saveEditCalc()"
          *ngIf="itemType != 'opportunitySheet'">Save</button>
        <button class="btn btn-primary btn-sm pull-right" (click)="saveEditOpportunitySheet()"
          *ngIf="itemType == 'opportunitySheet'">Save</button>
      </div>
    </div>
  </div>
</div>


<div bsModal #opportunitySheetModal="bs-modal" class="modal fade" tabindex="-1" role="dialog"
  aria-labelledby="opportunitySheetModalLabel" aria-hidden="true" [config]="{backdrop: 'static'}">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-body pl-0 pr-0" *ngIf="opportunitySheetModal.isShown">
        <app-opportunity-sheet (emitCancel)="hideOpportunitySheetModal()" (emitSave)="saveItemOpportunitySheet($event)"
          [(opportunitySheet)]="selectedEditOpportunitySheet">
        </app-opportunity-sheet>
      </div>
    </div>
  </div>
</div>

<div bsModal #deletedItemModal="bs-modal" class="modal fade" tabindex="-1" role="dialog"
  aria-labelledby="deletedItemModalLabel" aria-hidden="true" [config]="{backdrop: 'static'}">
  <div class="modal-dialog modal-sm">
    <div class="modal-content">
      <div class="modal-body p-2 text-center" *ngIf="deletedItemModal.isShown">
        Are you sure you want to delete "{{deleteItemName}}"?<br>
        <span class="small danger">This cannot be undone.</span>
      </div>
      <div class="modal-footer p-2 justify-content-end delete-modal">
        <button class="btn btn-danger" (click)="deleteItem()">Delete</button>
        <button class="btn btn-primary" (click)="cancelDelete()">Cancel</button>
      </div>
    </div>
  </div>
</div>