<div class="modal-card" [@modal]="showModal" *ngIf="!destroyModal">
  <div class="d-flex flex-column h-100">
    <div class="d-flex flex-wrap tabs primary">
      <div class="flex-fill panel-tab-item h-100" [ngClass]="{'active': tabSelect == 'import'}">
        <a class="border-left-0 h-100 d-flex justify-content-center align-items-center" (click)="setTab('import')">
          <div>Import Opportunities</div>
        </a>
      </div>
      <div class="flex-fill panel-tab-item h-100" [ngClass]="{'active': tabSelect == 'export'}">
        <a class="h-100 d-flex justify-content-center align-items-center" (click)="setTab('export')">
          <div>Export Opportunities</div>
        </a>
      </div>
    </div>
    <div class="d-flex flex-column flex-fill align-items-center bg-white" *ngIf="tabSelect == 'import'">
      <div class="d-flex flex-column pt-3">
        <label>Select File to Import</label>
        <input type="file" (change)="setImportFile($event)">
        <span class="help-text small">Must be an exported opportunity file from MEASUR.</span>
      </div>
      <div class="d-flex">
        <span class="alert-danger small" *ngIf="validFile == false">Invalid File. Make sure opportunity file is exported
          from this window within MEASUR.</span>
      </div>
      <div class="d-flex">
        <button class="btn btn-secondary" (click)="importFile()" [disabled]="validFile != true">Import</button>
      </div>
    </div>
    <div class="d-flex flex-column flex-fill align-items-center bg-white" *ngIf="tabSelect == 'export'">
      <!-- <div class="card-header">
            Export Selected Opportunities
          </div> -->
      <div class="d-flex flex-wrap">
        <div class="p-2" *ngIf="exportOpportunities.lightingReplacements">
          <label>Lighting Replacements</label>
          <ul>
            <li *ngFor="let replacement of exportOpportunities.lightingReplacements; let index = index;">
              <span *ngIf="!replacement.opportunitySheet || !replacement.opportunitySheet.name">
                Lighting Replacement #{{index+1}}
              </span>
              <span *ngIf="replacement.opportunitySheet && replacement.opportunitySheet.name">
                {{replacement.opportunitySheet.name}}
              </span>
            </li>
          </ul>
        </div>
        <div class="p-2" *ngIf="exportOpportunities.replaceExistingMotors">
          <label>Motor Replacements</label>
          <ul>
            <li *ngFor="let replaceExistingMotor of exportOpportunities.replaceExistingMotors; let index = index;">
              <span *ngIf="!replaceExistingMotor.opportunitySheet || !replaceExistingMotor.opportunitySheet.name">
                Replace Motor #{{index+1}}
              </span>
              <span *ngIf="replaceExistingMotor.opportunitySheet && replaceExistingMotor.opportunitySheet.name">
                {{replaceExistingMotor.opportunitySheet.name}}
              </span>
            </li>
          </ul>
        </div>
        <div class="p-2" *ngIf="exportOpportunities.motorDrives">
          <label>Upgrade Motor Drives</label>
          <ul>
            <li *ngFor="let motorDrive of exportOpportunities.motorDrives; let index = index;">
              <span *ngIf="!motorDrive.opportunitySheet || !motorDrive.opportunitySheet.name">
                Motor Drive #{{index+1}}
              </span>
              <span *ngIf="motorDrive.opportunitySheet && motorDrive.opportunitySheet.name">
                {{motorDrive.opportunitySheet.name}}
              </span>
            </li>
          </ul>
        </div>
        <div class="p-2" *ngIf="exportOpportunities.naturalGasReductions">
          <label>Natural Gas Reductions</label>
          <ul>
            <li *ngFor="let naturalGasReduction of exportOpportunities.naturalGasReductions; let index = index;">
              <span *ngIf="!naturalGasReduction.opportunitySheet || !naturalGasReduction.opportunitySheet.name">
                Natural Gas Reduction #{{index+1}}
              </span>
              <span *ngIf="naturalGasReduction.opportunitySheet && naturalGasReduction.opportunitySheet.name">
                {{naturalGasReduction.opportunitySheet.name}}
              </span>
            </li>
          </ul>
        </div>
        <div class="p-2" *ngIf="exportOpportunities.electricityReductions">
          <label>Electricity Reductions</label>
          <ul>
            <li *ngFor="let electricityReduction of exportOpportunities.electricityReductions; let index = index;">
              <span *ngIf="!electricityReduction.opportunitySheet || !electricityReduction.opportunitySheet.name">
                Electricity Reduction #{{index+1}}
              </span>
              <span *ngIf="electricityReduction.opportunitySheet && electricityReduction.opportunitySheet.name">
                {{electricityReduction.opportunitySheet.name}}
              </span>
            </li>
          </ul>
        </div>
        <div class="p-2" *ngIf="exportOpportunities.compressedAirReductions">
          <label>Compressed Air Reductions</label>
          <ul>
            <li *ngFor="let compressedAirReduction of exportOpportunities.compressedAirReductions; let index = index;">
              <span *ngIf="!compressedAirReduction.opportunitySheet || !compressedAirReduction.opportunitySheet.name">
                Compressed Air Reduction #{{index+1}}
              </span>
              <span *ngIf="compressedAirReduction.opportunitySheet && compressedAirReduction.opportunitySheet.name">
                {{compressedAirReduction.opportunitySheet.name}}
              </span>
            </li>
          </ul>
        </div>
        <div class="p-2" *ngIf="exportOpportunities.opportunitySheets">
          <label>Opportunity Sheets</label>
          <ul>
            <li *ngFor="let opportunitySheet of exportOpportunities.opportunitySheets; let index = index;">
              <span *ngIf="!opportunitySheet.name">
                Opportunity Sheet #{{index+1}}
              </span>
              <span *ngIf="opportunitySheet.name">
                {{opportunitySheet.name}}
              </span>
            </li>
          </ul>
        </div>
      </div>
      <div class="p-2">
        <button class="btn btn-secondary pull-right" (click)="exportData()">Export</button>
      </div>
    </div>
    <div class="d-flex w-100 justify-content-end bg-white p-2">
      <button class="btn btn-danger" (click)="closeModal()">Cancel</button>
    </div>
  </div>